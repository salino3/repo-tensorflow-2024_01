<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ml5</title>

    <script src="https://unpkg.com/ml5@0.1.3/dist/ml5.min.js"></script>
  </head>

  <body>
    <h1>Image classifier MobileNet</h1>
    <img src="" crossorigin="anonymous" alt="Animal" id="imagen" /> <br />
    <br />
    <button onclick="nextAnimal()">Next animal</button>
    <p>
      This is a
      <strong>
        <span id="result"> ... </span>
      </strong>
      <br />
      <br />
      with a certainty of
      <strong>
        <span id="probability"> ...</span>
      </strong>
    </p>

    <script>
      const imageNames = [
        "aguila-1",
        "aguila-2",
        "ant-1",
        "ant-2",
        "gatito-1",
        "gato-1",
        "gato-2",
        "gatos-2",
        "perro-1",
        "perro-2",
        "perro-3",
      ];

      let num = 0;
      const image = document.getElementById("imagen");
      const result = document.getElementById("result");
      const probability = document.getElementById("probability");

      image.src = `./src/images/${imageNames[num]}.jpg`;

      function nextAnimal() {
        if (imageNames.length - 1 <= num) {
          num = 0;
        } else {
          num = num + 1;
        }
        image.src = `./src/images/${imageNames[num]}.jpg`;
        console.log("Num", imageNames.length, num);
        classifier.predict(image, function (err, res) {
          // console.log("Res: ", res);
          result.innerText = res[0].className;
          probability.innerText = `${res[0].probability.toFixed(4)} %`;
        });
      }
      const classifier = ml5.imageClassifier("MobileNet", function () {
        console.log("Modelo cargado");
      });

      classifier.predict(image, function (err, res) {
        // console.log("Res: ", res);
        result.innerText = res[0].className;
        probability.innerText = `${res[0].probability.toFixed(4)} %`;
      });
    </script>
  </body>
</html>
